<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript 学习</title>
</head>

<body>
    <script>
        // 学习闭包，手写闭包
        var fn = function () {
            var count = 1
            console.log('1', count); //log
            return (
                function () {
                    console.log('count', count); //log
                }
            )()
        }
        fn()

        // 闭包的运用
        var shop = (function Shop() {
                var totlePrice = 1000

                var price = 0

                return {
                    pay: function (val) {

                        price = price + val
                        console.log('price', price); //log
                    },
                    buy:function(){
                        if (price>totlePrice) {
                            console.log('恭喜你，忠实的'); //log
                        } else {
                            console.log('还没有你的事'); //log
                        }
                    },
                    
                }
            }
        )();
        shop.pay(10)



        // 构造函数

        function Preson() {
            this.name = '墨书白'
            console.log('this', this); //log
            this.say = function () {
                console.log('name', this.name); //log
            }

        }
        Preson.prototype.talk = function () {
            console.log('prototype:this', this); //log
        }

        var np = new Preson()
        console.log('np', np); //log
        np.say()
        np.talk()

        // 类 class
        class Npreson {
            constructor() {
                this.max = 10
                this.name = '墨书白'
            }
            say() {
                console.log('构造函数：this.name', this.name); //log
            }
        }
        var cla = new Npreson()
        console.log('cla', cla); //log
        cla.say()

        // 
        function Animal(name, age, gender) {
            console.log('this', this); //log
            this.name = name;
            this.age = age;
            this.gender = gender;
        }
        function Person(name, age, gender, say) {
            //这段代码调用错误
            //为什么错误？
            //因为这种函数的调用方式，函数内部的this只能指向window
            //Animal(name,age,gender);
            //目的：将Animal函数内部的this指向Person的实例
            //Animal.call(this,name,age,gender)
            //-->等价于：
            Animal.apply(this, [name, age, gender])
            this.say = say;
        }
        var nAimal = new Animal()
        console.log('Animal', nAimal); //log

        var p1 = new Person("墨书白", 27, "男",
            function () {

            });
        console.log('p1', p1); //log


    </script>
</body>

</html>